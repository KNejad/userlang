<!doctype html>
<head>

	<title> UserLang | Favorite language finder </title>
</head>
<body>
	<script>
function processName(){
	var username = document.getElementById("form-user-name").value;
	var url = "https://api.github.com/users/" + username + "/repos";
	httpGet(url,function getLanguages(response) {
		var githubResult = JSON.parse(response);
		numContributedRepos = Object.keys(githubResult).length;


		//parse through each repo and get commits created by usernam
		//greater than is OK because index starts at 0 so we want to stop counting one before reaching the contributedRepos
		var languages = [];
		for (var repoNum = 0;  repoNum < numContributedRepos; repoNum++){
			httpGet(githubResult[repoNum]["languages_url"], function printLanguages(responce){
				githubResult = JSON.parse(responce);

				numLanguages = Object.keys(githubResult).length;
				var index = 0;
				while(index < numLanguages){
					if(Object.keys(githubResult)[index] in languages){
						languages[Object.keys(githubResult)[index]] =  languages[Object.keys(githubResult)[index]] + githubResult[Object.keys(githubResult)[index]];
					}else{
						languages[Object.keys(githubResult)[index]] =  githubResult[Object.keys(githubResult)[index]];				
					}
					index++;
				}
			});

		}
		console.log(languages);
	});
	//returns false so page does not refresh
	return false;


}
function httpGet(url, callback){
	var xmlHttp = new XMLHttpRequest();
	xmlHttp.onreadystatechange = function() { 
		if (xmlHttp.readyState == 4 && xmlHttp.status == 200){
			callback(xmlHttp.responseText);
		}
	}
	xmlHttp.open("GET", url, true); 
	xmlHttp.send(null);
}
	</script>

	<form name="search"  onsubmit="return processName()" >
		Username: <input type="text" name="name" id="form-user-name">
		<input type="submit" name="Submit" value="Submit">
	</form>

</body>


</html>



